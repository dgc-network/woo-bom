function getPostsFromServer(t){doAjax(giar_settings.endpoints.posts,{}).done(function(e){posts=e,"function"==typeof t&&t.call()})}function getRandomPost(){var t=posts[Math.floor(Math.random()*posts.length)],e=$el.data("post");return"object"==typeof e&&e.ID===t.ID&&(t=getRandomPost()),t}function showPost(t){$el.data("currentPost",t),$el.find("h1").text(t.title),$el.find(".votes .up").text(t.upvotes),$el.find(".votes .down").text(t.downvotes)}function getLS(t){var e=window.localStorage.getItem(t);try{return JSON.parse(e)}catch(t){return e}}function setLS(t,e){return window.localStorage.setItem(t,JSON.stringify(e))}function voteOnPost(t,e){var o=getLS("readingList")||[];"up"===e&&-1===o.indexOf(t.ID)&&(o.push(t.ID),setLS("readingList",o),addReadingListElem(t)),showPost(getRandomPost()),doAjax(giar_settings.endpoints.vote,{vote:e,id:t.ID})}function addReadingListElem(t){$el.find(".reading-list ul").append('<li data-id="'+t.ID+'"><a target=_blank href="'+t.permalink+'">'+t.title+"</a></li>")}function doAjax(t,e){return $.ajax({url:giar_settings.api_base+t.route,method:t.method,data:e})}var giar_settings={api_base:"http://give-it-a-rest.dev/wp-json/give-it-a-rest/v1/",endpoints:{posts:{route:"list-posts/",method:"GET"},vote:{route:"vote/",method:"POST"}}},$el,posts={},votedOn=JSON.parse(localStorage.getItem("giar_votedOn"));$(function(){function t(){showPost(getRandomPost()),$el.find(".reading-list ul").empty(),$.each(getLS("readingList"),function(t,e){$.each(posts,function(t,o){o.ID===e&&addReadingListElem(o)})})}$el=$(".giar"),getPostsFromServer(t),$el.on("click",".votes span",function(t){voteOnPost($el.data("currentPost"),$(this).attr("class"))}),$el.on("click",".clear-list",function(t){t.preventDefault(),setLS("readingList",[]),$el.find(".reading-list ul").empty()})});